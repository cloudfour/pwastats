/*
 Copyright 2016 Google Inc. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
(function(t,r){'object'==typeof exports&&'undefined'!=typeof module?module.exports=r():'function'==typeof define&&define.amd?define(r):(t.goog=t.goog||{},t.goog.swlib=r())})(this,function(){'use strict';function createCommonjsModule(ae,ne){return ne={exports:{}},ae(ne,ne.exports),ne.exports}function throwError(ae){const ne=new Error(ae),se=d.parse(ne);throw 3<=se.length&&(ne.message=`Invalid call to ${se[2].functionName}() â€” `+ae.replace(/\s+/g,' '),ne.name=se[1].functionName.replace(/^Object\./,'')),ne}function parse(ae,ne){for(var de,se=[],ie=0,oe=0,ce='',le=ne&&ne.delimiter||'/';null!=(de=x.exec(ae));){var ue=de[0],pe=de[1],he=de.index;if(ce+=ae.slice(oe,he),oe=he+ue.length,pe){ce+=pe[1];continue}var me=ae[oe],ge=de[2],fe=de[3],ye=de[4],be=de[5],_e=de[6],ve=de[7];ce&&(se.push(ce),ce='');var xe=de[2]||le,ke=ye||be;se.push({name:fe||ie++,prefix:ge||'',delimiter:xe,optional:'?'===_e||'*'===_e,repeat:'+'===_e||'*'===_e,partial:null!=ge&&null!=me&&me!==ge,asterisk:!!ve,pattern:ke?escapeGroup(ke):ve?'.*':'[^'+escapeString(xe)+']+?'})}return oe<ae.length&&(ce+=ae.substr(oe)),ce&&se.push(ce),se}function encodeURIComponentPretty(ae){return encodeURI(ae).replace(/[\/?#]/g,function(ne){return'%'+ne.charCodeAt(0).toString(16).toUpperCase()})}function encodeAsterisk(ae){return encodeURI(ae).replace(/[?#]/g,function(ne){return'%'+ne.charCodeAt(0).toString(16).toUpperCase()})}function tokensToFunction(ae){for(var ne=Array(ae.length),se=0;se<ae.length;se++)'object'==typeof ae[se]&&(ne[se]=new RegExp('^(?:'+ae[se].pattern+')$'));return function(ie,oe){for(var he,ce='',le=ie||{},de=oe||{},ue=de.pretty?encodeURIComponentPretty:encodeURIComponent,pe=0;pe<ae.length;pe++){if(he=ae[pe],'string'==typeof he){ce+=he;continue}var ge,me=le[he.name];if(null==me)if(he.optional){he.partial&&(ce+=he.prefix);continue}else throw new TypeError('Expected "'+he.name+'" to be defined');if(y(me)){if(!he.repeat)throw new TypeError('Expected "'+he.name+'" to not repeat, but received `'+JSON.stringify(me)+'`');if(0===me.length)if(he.optional)continue;else throw new TypeError('Expected "'+he.name+'" to not be empty');for(var fe=0;fe<me.length;fe++){if(ge=ue(me[fe]),!ne[pe].test(ge))throw new TypeError('Expected all "'+he.name+'" to match "'+he.pattern+'", but received `'+JSON.stringify(ge)+'`');ce+=(0===fe?he.prefix:he.delimiter)+ge}continue}if(ge=he.asterisk?encodeAsterisk(me):ue(me),!ne[pe].test(ge))throw new TypeError('Expected "'+he.name+'" to match "'+he.pattern+'", but received "'+ge+'"');ce+=he.prefix+ge}return ce}}function escapeString(ae){return ae.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function escapeGroup(ae){return ae.replace(/([=!:$\/()])/g,'\\$1')}function attachKeys(ae,ne){return ae.keys=ne,ae}function flags(ae){return ae.sensitive?'':'i'}function regexpToRegexp(ae,ne){var se=ae.source.match(/\((?!\?)/g);if(se)for(var ie=0;ie<se.length;ie++)ne.push({name:ie,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return attachKeys(ae,ne)}function arrayToRegexp(ae,ne,se){for(var ie=[],oe=0;oe<ae.length;oe++)ie.push(pathToRegexp(ae[oe],ne,se).source);var ce=new RegExp('(?:'+ie.join('|')+')',flags(se));return attachKeys(ce,ne)}function stringToRegexp(ae,ne,se){return tokensToRegExp(parse(ae,se),ne,se)}function tokensToRegExp(ae,ne,se){y(ne)||(se=ne||se,ne=[]),se=se||{};for(var de,ie=se.strict,oe=!1!==se.end,ce='',le=0;le<ae.length;le++)if(de=ae[le],'string'==typeof de)ce+=escapeString(de);else{var ue=escapeString(de.prefix),pe='(?:'+de.pattern+')';ne.push(de),de.repeat&&(pe+='(?:'+ue+pe+')*'),pe=de.optional?de.partial?ue+'('+pe+')?':'(?:'+ue+'('+pe+'))?':ue+'('+pe+')',ce+=pe}var he=escapeString(se.delimiter||'/'),me=ce.slice(-he.length)===he;return ie||(ce=(me?ce.slice(0,-he.length):ce)+'(?:'+he+'(?=$))?'),ce+=oe?'$':ie&&me?'':'(?='+he+'|$)',attachKeys(new RegExp('^'+ce,flags(se)),ne)}function pathToRegexp(ae,ne,se){return y(ne)||(se=ne||se,ne=[]),se=se||{},ae instanceof RegExp?regexpToRegexp(ae,ne):y(ae)?arrayToRegexp(ae,ne,se):stringToRegexp(ae,ne,se)}function broadcastUpdate({channel:ae,cacheName:ne,url:se,source:ie}){u.isInstance({channel:ae},BroadcastChannel),u.isType({cacheName:ne},'string'),u.isType({source:ie},'string'),u.isType({url:se},'string'),ae.postMessage({type:Z,meta:ie,payload:{cacheName:ne,updatedUrl:se}})}function responsesAreSame({first:ae,second:ne,headersToCheck:se}={}){if(!(ae instanceof Response&&ne instanceof Response&&se instanceof Array))throw J.createError('responses-are-same-parameters-required');return se.every((ie)=>{return ae.headers.has(ie)===ne.headers.has(ie)&&ae.headers.get(ie)===ne.headers.get(ie)})}class ErrorFactory$1{constructor(ae){this._errors=ae}createError(ae,ne){if(!(ae in this._errors))throw new Error(`Unable to generate error '${ae}'.`);let se=this._errors[ae].replace(/\s+/g,' '),ie=null;ne&&(se+=` [${ne.message}]`,ie=ne.stack);const oe=new Error;return oe.name=ae,oe.message=se,oe.stack=ie,oe}}const t={'not-in-sw':'sw-lib must be loaded in your service worker file.','unsupported-route-type':'Routes must be either a express style route string, a Regex to capture request URLs or a Route instance.','empty-express-string':'The Express style route string must have some characters, an empty string is invalid.','bad-revisioned-cache-list':`The 'cacheRevisionedAssets()' method expects`+`an array of revisioned urls like so: ['/example/hello.1234.txt', `+`{path: 'hello.txt', revision: '1234'}]`,'navigation-route-url-string':`The registerNavigationRoute() method `+`expects a URL string as its first parameter.`};var r=new ErrorFactory$1(t);const a={'express-route-requires-absolute-path':`When using ExpressRoute, you must
    provide a path that starts with a '/' character. You can only match
    same-origin requests. For more flexibility, use RegExpRoute.`};var s=new ErrorFactory$1(a),o='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,l=createCommonjsModule(function(ae){(function(se,ie){'use strict';ae.exports=ie()})(o,function(){'use strict';function _isNumber(pe){return!isNaN(parseFloat(pe))&&isFinite(pe)}function _capitalize(pe){return pe[0].toUpperCase()+pe.substring(1)}function _getter(pe){return function(){return this[pe]}}function StackFrame(pe){if(pe instanceof Object)for(var he=se.concat(ie.concat(oe.concat(ce))),me=0;me<he.length;me++)pe.hasOwnProperty(he[me])&&void 0!==pe[he[me]]&&this['set'+_capitalize(he[me])](pe[he[me]])}var se=['isConstructor','isEval','isNative','isToplevel'],ie=['columnNumber','lineNumber'],oe=['fileName','functionName','source'],ce=['args'];StackFrame.prototype={getArgs:function(){return this.args},setArgs:function(pe){if('[object Array]'!==Object.prototype.toString.call(pe))throw new TypeError('Args must be an Array');this.args=pe},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(pe){if(pe instanceof StackFrame)this.evalOrigin=pe;else if(pe instanceof Object)this.evalOrigin=new StackFrame(pe);else throw new TypeError('Eval Origin must be an Object or StackFrame')},toString:function(){var pe=this.getFunctionName()||'{anonymous}',he='('+(this.getArgs()||[]).join(',')+')',me=this.getFileName()?'@'+this.getFileName():'',ge=_isNumber(this.getLineNumber())?':'+this.getLineNumber():'',fe=_isNumber(this.getColumnNumber())?':'+this.getColumnNumber():'';return pe+he+me+ge+fe}};for(var le=0;le<se.length;le++)StackFrame.prototype['get'+_capitalize(se[le])]=_getter(se[le]),StackFrame.prototype['set'+_capitalize(se[le])]=function(pe){return function(he){this[pe]=!!he}}(se[le]);for(var de=0;de<ie.length;de++)StackFrame.prototype['get'+_capitalize(ie[de])]=_getter(ie[de]),StackFrame.prototype['set'+_capitalize(ie[de])]=function(pe){return function(he){if(!_isNumber(he))throw new TypeError(pe+' must be a Number');this[pe]=+he}}(ie[de]);for(var ue=0;ue<oe.length;ue++)StackFrame.prototype['get'+_capitalize(oe[ue])]=_getter(oe[ue]),StackFrame.prototype['set'+_capitalize(oe[ue])]=function(pe){return function(he){this[pe]=he+''}}(oe[ue]);return StackFrame})}),d=createCommonjsModule(function(ae){(function(se,ie){'use strict';ae.exports=ie(l)})(o,function ErrorStackParser(se){'use strict';var ie=/(^|@)\S+\:\d+/,oe=/^\s*at .*(\S+\:\d+|\(native\))/m,ce=/^(eval@)?(\[native code\])?$/;return{parse:function ErrorStackParser$$parse(le){if('undefined'!=typeof le.stacktrace||'undefined'!=typeof le['opera#sourceloc'])return this.parseOpera(le);if(le.stack&&le.stack.match(oe))return this.parseV8OrIE(le);if(le.stack)return this.parseFFOrSafari(le);throw new Error('Cannot parse given Error object')},extractLocation:function ErrorStackParser$$extractLocation(le){if(-1===le.indexOf(':'))return[le];var de=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,ue=de.exec(le.replace(/[\(\)]/g,''));return[ue[1],ue[2]||void 0,ue[3]||void 0]},parseV8OrIE:function ErrorStackParser$$parseV8OrIE(le){var de=le.stack.split('\n').filter(function(ue){return!!ue.match(oe)},this);return de.map(function(ue){-1<ue.indexOf('(eval ')&&(ue=ue.replace(/eval code/g,'eval').replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,''));var pe=ue.replace(/^\s+/,'').replace(/\(eval code/g,'(').split(/\s+/).slice(1),he=this.extractLocation(pe.pop()),me=pe.join(' ')||void 0,ge=-1<['eval','<anonymous>'].indexOf(he[0])?void 0:he[0];return new se({functionName:me,fileName:ge,lineNumber:he[1],columnNumber:he[2],source:ue})},this)},parseFFOrSafari:function ErrorStackParser$$parseFFOrSafari(le){var de=le.stack.split('\n').filter(function(ue){return!ue.match(ce)},this);return de.map(function(ue){if(-1<ue.indexOf(' > eval')&&(ue=ue.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,':$1')),-1===ue.indexOf('@')&&-1===ue.indexOf(':'))return new se({functionName:ue});var pe=ue.split('@'),he=this.extractLocation(pe.pop()),me=pe.join('@')||void 0;return new se({functionName:me,fileName:he[0],lineNumber:he[1],columnNumber:he[2],source:ue})},this)},parseOpera:function ErrorStackParser$$parseOpera(le){return!le.stacktrace||-1<le.message.indexOf('\n')&&le.message.split('\n').length>le.stacktrace.split('\n').length?this.parseOpera9(le):le.stack?this.parseOpera11(le):this.parseOpera10(le)},parseOpera9:function ErrorStackParser$$parseOpera9(le){for(var ge,de=/Line (\d+).*script (?:in )?(\S+)/i,ue=le.message.split('\n'),pe=[],he=2,me=ue.length;he<me;he+=2)ge=de.exec(ue[he]),ge&&pe.push(new se({fileName:ge[2],lineNumber:ge[1],source:ue[he]}));return pe},parseOpera10:function ErrorStackParser$$parseOpera10(le){for(var ge,de=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,ue=le.stacktrace.split('\n'),pe=[],he=0,me=ue.length;he<me;he+=2)ge=de.exec(ue[he]),ge&&pe.push(new se({functionName:ge[3]||void 0,fileName:ge[2],lineNumber:ge[1],source:ue[he]}));return pe},parseOpera11:function ErrorStackParser$$parseOpera11(le){var de=le.stack.split('\n').filter(function(ue){return!!ue.match(ie)&&!ue.match(/^Error created at/)},this);return de.map(function(ue){var pe=ue.split('@'),he=this.extractLocation(pe.pop()),me=pe.shift()||'',ge=me.replace(/<anonymous function(: (\w+))?>/,'$2').replace(/\([^\)]*\)/g,'')||void 0,fe;me.match(/\(([^\)]*)\)/)&&(fe=me.replace(/^[^\(]+\(([^\)]*)\)$/,'$1'));var ye=fe===void 0||'[arguments not available]'===fe?void 0:fe.split(',');return new se({functionName:ge,args:ye,fileName:he[0],lineNumber:he[1],columnNumber:he[2],source:ue})},this)}}})}),u={atLeastOne:function atLeastOne(ae){const ne=Object.keys(ae);ne.some((se)=>ae[se]!==void 0)||throwError('Please set at least one of the following parameters: '+ne.map((se)=>`'${se}'`).join(', '))},hasMethod:function hasMethod(ae,ne){const se=Object.keys(ae).pop(),ie=typeof ae[se][ne];'function'!=ie&&throwError(`The '${se}' parameter must be an object that exposes a
      '${ne}' method.`)},isInstance:function isInstance(ae,ne){const se=Object.keys(ae).pop();ae[se]instanceof ne||throwError(`The '${se}' parameter must be an instance of
      '${ne.name}'`)},isOneOf:function isOneOf(ae,ne){const se=Object.keys(ae).pop();ne.includes(ae[se])||throwError(`The '${se}' parameter must be set to one of the
      following: ${ne}`)},isType:function isType(ae,ne){const se=Object.keys(ae).pop(),ie=typeof ae[se];ie!==ne&&throwError(`The '${se}' parameter has the wrong type. (Expected:
      ${ne}, actual: ${ie})`)},isSWEnv:function isSWEnv(){return'ServiceWorkerGlobalScope'in self&&self instanceof ServiceWorkerGlobalScope},isValue:function isValue(ae,ne){const se=Object.keys(ae).pop(),ie=ae[se];ie!==ne&&throwError(`The '${se}' parameter has the wrong value. (Expected: 
      ${ne}, actual: ${ie})`)},isArrayOfType:function isArrayOfType(ae,ne){const se=Object.keys(ae).pop(),ie=`The '${se}' parameter should be an array containing
    one or more '${ne}' elements.`;Array.isArray(ae[se])||throwError(ie);for(let oe of ae[se])typeof oe!==ne&&throwError(ie)},isArrayOfClass:function isArrayOfClass(ae,ne){const se=Object.keys(ae).pop(),ie=`The '${se}' parameter should be an array containing
    one or more '${ne.name}' instances.`;Array.isArray(ae[se])||throwError(ie);for(let oe of ae[se])oe instanceof ne||throwError(ie)}};const g=['DELETE','GET','HEAD','POST','PUT'];class Route{constructor({match:ae,handler:ne,method:se}={}){u.isType({match:ae},'function'),'object'==typeof ne?u.hasMethod({handler:ne},'handle'):u.isType({handler:ne},'function'),this.match=ae,this.handler='function'==typeof ne?{handle:ne}:ne,se?(u.isOneOf({method:se},g),this.method=se):this.method='GET'}}var f=Array.isArray||function(ae){return'[object Array]'==Object.prototype.toString.call(ae)},y=f,b=pathToRegexp,x=new RegExp(['(\\\\.)','([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))'].join('|'),'g');b.parse=parse,b.compile=function compile(ae,ne){return tokensToFunction(parse(ae,ne))},b.tokensToFunction=tokensToFunction,b.tokensToRegExp=tokensToRegExp;class ExpressRoute extends Route{constructor({path:ae,handler:ne,method:se}){if('/'!==ae.substring(0,1))throw s.createError('express-route-requires-absolute-path');let ie=[];const oe=b(ae,ie);super({match:({url:le})=>{if(le.origin!==location.origin)return null;const de=le.pathname.match(oe);if(!de)return null;const ue={};return ie.forEach((pe,he)=>{ue[pe.name]=de[he+1]}),ue},handler:ne,method:se})}}class NavigationRoute extends Route{constructor({whitelist:ae,blacklist:ne,handler:se}={}){u.isArrayOfClass({whitelist:ae},RegExp),ne?u.isArrayOfClass({blacklist:ne},RegExp):ne=[];super({match:({event:oe,url:ce})=>{return'navigate'===oe.request.mode&&ae.some((le)=>le.test(ce.pathname))&&!ne.some((le)=>le.test(ce.pathname))},handler:se,method:'GET'})}}class RegExpRoute extends Route{constructor({regExp:ae,handler:ne,method:se}){u.isInstance({regExp:ae},RegExp);super({match:({url:oe})=>{const ce=oe.href.match(ae);return ce?ce.slice(1):null},handler:ne,method:se})}}self.goog=self.goog||{},self.goog.LOG_LEVEL=self.goog.LOG_LEVEL||{none:-1,verbose:0,debug:1,warn:2,error:3};var q=new class LogHelper{constructor(){this._allowedLogLevel='localhost'===location.hostname?self.goog.LOG_LEVEL.debug:self.goog.LOG_LEVEL.none}log(...ae){this._printMessage(self.goog.LOG_LEVEL.verbose,console.log,ae)}debug(...ae){this._printMessage(self.goog.LOG_LEVEL.debug,console.debug,ae)}warn(...ae){this._printMessage(self.goog.LOG_LEVEL.warn,console.warn,ae)}error(...ae){this._printMessage(self.goog.LOG_LEVEL.error,console.error,ae)}_printMessage(ae,ne,se){let ie=this._allowedLogLevel;self&&self.goog&&self.goog.logLevel&&(ie=self.goog.logLevel);ie===self.goog.LOG_LEVEL.none||ae<ie||ne(...se)}};class Router$2{setDefaultHandler({handler:ae}={}){u.hasMethod({handler:ae},'handle'),this.defaultHandler=ae}setCatchHandler({handler:ae}={}){u.hasMethod({handler:ae},'handle'),this.catchHandler=ae}registerRoutes({routes:ae}={}){u.isArrayOfClass({routes:ae},Route),self.addEventListener('fetch',(ne)=>{const se=new URL(ne.request.url);if(!se.protocol.startsWith('http'))return void q.debug(`[router.js] URL does not start with HTTP`,ne.request.url);let ie;for(let oe of ae||[])if(oe.method===ne.request.method){const ce=oe.match({url:se,event:ne});if(ce){q.debug(`[router.js] Found matching result: `,ne.request.url);let le=ce;Array.isArray(le)&&0===le.length?le=void 0:le.constructor===Object&&0===Object.keys(le).length&&(le=void 0),ie=oe.handler.handle({url:se,event:ne,params:le});break}}!ie&&this.defaultHandler&&(ie=this.defaultHandler.handle({url:se,event:ne})),ie&&this.catchHandler&&(ie=ie.catch((oe)=>{return this.catchHandler.handle({url:se,event:ne,error:oe})})),ie&&ne.respondWith(ie.then((oe)=>{return q.debug(`[router.js] Returning response for `+`'${ne.request.url}': `,oe),oe}))})}registerRoute({route:ae}={}){u.isInstance({route:ae},Route),this.registerRoutes({routes:[ae]})}}class Router$$1 extends Router$2{registerRoute(ae,ne){if('function'==typeof ne&&(ne={handle:ne}),'string'==typeof ae){if(0===ae.length)throw r.createError('empty-express-string');super.registerRoute({route:new ExpressRoute({path:ae,handler:ne})})}else if(ae instanceof RegExp)super.registerRoute({route:new RegExpRoute({regExp:ae,handler:ne})});else if(ae instanceof Route)super.registerRoute({route:ae});else throw r.createError('unsupported-route-type')}registerNavigationRoute(ae,ne={}){if('string'!=typeof ae)throw r.createError('navigation-route-url-string');super.registerRoute({route:new NavigationRoute({handler:()=>caches.match(ae),whitelist:ne.whitelist||[/./],blacklist:ne.blacklist||[]})})}}const O={'not-in-sw':'sw-precaching must be loaded in your service worker file.','invalid-revisioned-entry':`File manifest entries must be either a `+`string with revision info in the url or an object with a 'url' and `+`'revision' parameters.`,'invalid-unrevisioned-entry':``,'bad-cache-bust':`The cache bust parameter must be a boolean.`,'duplicate-entry-diff-revisions':`An attempt was made to cache the same `+`url twice with each having different revisions. This is not supported.`,'request-not-cached':`A request failed the criteria to be cached. By `+`default, only responses with 'response.ok = true' are cached.`,'should-override':'Method should be overridden by the extending class.'};var T=new ErrorFactory$1(O);let w=`sw-runtime-caching`;self&&self.registration&&(w+=`-${self.registration.scope}`);const L=w,I=['cacheDidUpdate','cacheWillMatch','cacheWillUpdate','fetchDidFail','requestWillFetch'];var A=new ErrorFactory$1({'multiple-cache-will-update-plugins':'You cannot register more than one plugin that implements cacheWillUpdate.','multiple-cache-will-match-plugins':'You cannot register more than one plugin that implements cacheWillMatch.','invalid-reponse-for-caching':'The fetched response could not be cached due to an invalid response code, by default only 20X responses can be cached.'}),D=function(ae){return function(){var ne=ae.apply(this,arguments);return new Promise(function(se,ie){function step(oe,ce){try{var le=ne[oe](ce),de=le.value}catch(ue){return void ie(ue)}return le.done?void se(de):Promise.resolve(de).then(function(ue){step('next',ue)},function(ue){step('throw',ue)})}return step('next')})}};class RequestWrapper{constructor({cacheName:ae,plugins:ne,fetchOptions:se,matchOptions:ie}={}){if(ae?(u.isType({cacheName:ae},'string'),this.cacheName=ae):this.cacheName=L,se&&(u.isType({fetchOptions:se},'object'),this.fetchOptions=se),ie&&(u.isType({matchOptions:ie},'object'),this.matchOptions=ie),this.pluginCallbacks={},ne&&(u.isArrayOfType({plugins:ne},'object'),ne.forEach((oe)=>{for(let ce of I)'function'==typeof oe[ce]&&(this.pluginCallbacks[ce]||(this.pluginCallbacks[ce]=[]),this.pluginCallbacks[ce].push(oe[ce].bind(oe)))})),this.pluginCallbacks.cacheWillUpdate&&1!==this.pluginCallbacks.cacheWillUpdate.length)throw A.createError('multiple-cache-will-update-plugins');if(this.pluginCallbacks.cacheWillMatch&&1!==this.pluginCallbacks.cacheWillMatch.length)throw A.createError('multiple-cache-will-match-plugins')}getCache(){var ae=this;return D(function*(){return ae._cache||(ae._cache=yield caches.open(ae.cacheName)),ae._cache})()}match({request:ae}){var ne=this;return D(function*(){u.atLeastOne({request:ae});const se=yield ne.getCache();let ie=yield se.match(ae,ne.matchOptions);return ne.pluginCallbacks.cacheWillMatch&&(ie=ne.pluginCallbacks.cacheWillMatch[0]({cachedResponse:ie})),ie})()}fetch({request:ae}){var ne=this;return D(function*(){u.atLeastOne({request:ae});const se=ne.pluginCallbacks.fetchDidFail?ae.clone():null;if(ne.pluginCallbacks.requestWillFetch)for(let ie of ne.pluginCallbacks.requestWillFetch){const oe=ie({request:ae});u.isInstance({returnedPromise:oe},Promise);const ce=yield oe;u.isInstance({returnedRequest:ce},Request),ae=ce}try{return yield fetch(ae,ne.fetchOptions)}catch(ie){if(ne.pluginCallbacks.fetchDidFail)for(let oe of ne.pluginCallbacks.fetchDidFail)oe({request:se.clone()});throw ie}})()}fetchAndCache({request:ae,waitOnCache:ne,cacheKey:se}){var ie=this;return D(function*(){u.atLeastOne({request:ae});let oe;const ce=yield ie.fetch({request:ae});let le=ce.ok;if(ie.pluginCallbacks.cacheWillUpdate&&(le=ie.pluginCallbacks.cacheWillUpdate[0]({request:ae,response:ce})),le){const de=ce.clone();oe=ie.getCache().then((()=>{var ue=D(function*(pe){let he;'opaque'!==ce.type&&ie.pluginCallbacks.cacheDidUpdate&&(he=yield ie.match({request:ae}));yield pe.put(se||ae,de);for(let ge of ie.pluginCallbacks.cacheDidUpdate||[])ge({cacheName:ie.cacheName,oldResponse:he,newResponse:de,url:ae.url})});return function(){return ue.apply(this,arguments)}})())}else if(!le&&(q.debug(`[RequestWrapper] The response for ${ae.url}, with 
        a status of ${ce.status}, wasn't cached. By default, only
        responses with a status of 200 are cached. You can configure the
        cacheableResponse plugin to change this default.`.replace(/\s+/g,' ')),ne))throw A.createError('invalid-reponse-for-caching');return ne&&oe&&(yield oe),ce})()}}class Handler{constructor({requestWrapper:ae}={}){this.requestWrapper=ae?ae:new RequestWrapper}handle({event:ae,params:ne}={}){throw Error('This abstract method must be implemented in a subclass.')}}class CacheFirst extends Handler{handle({event:ae}={}){var ne=this;return D(function*(){u.isInstance({event:ae},FetchEvent);const se=yield ne.requestWrapper.match({request:ae.request});return se||(yield ne.requestWrapper.fetchAndCache({request:ae.request}))})()}}class CacheOnly extends Handler{handle({event:ae}={}){var ne=this;return D(function*(){return u.isInstance({event:ae},FetchEvent),yield ne.requestWrapper.match({request:ae.request})})()}}class NetworkFirst extends Handler{constructor(ae={}){super(ae);const{networkTimeoutSeconds:ne}=ae;ne&&(u.isType({networkTimeoutSeconds:ne},'number'),this.networkTimeoutSeconds=ne)}handle({event:ae}={}){var ne=this;return D(function*(){u.isInstance({event:ae},FetchEvent);const se=[];let ie;return ne.networkTimeoutSeconds&&se.push(new Promise(function(oe){ie=setTimeout(function(){oe(ne.requestWrapper.match({request:ae.request}))},1e3*ne.networkTimeoutSeconds)})),se.push(ne.requestWrapper.fetchAndCache({request:ae.request}).then(function(oe){return ie&&clearTimeout(ie),oe?oe:Promise.reject('No response received; falling back to cache.')}).catch(function(){return ne.requestWrapper.match({request:ae.request})})),Promise.race(se)})()}}class NetworkOnly extends Handler{handle({event:ae}={}){var ne=this;return D(function*(){return u.isInstance({event:ae},FetchEvent),yield ne.requestWrapper.fetch({request:ae.request})})()}}class StaleWhileRevalidate extends Handler{handle({event:ae}={}){var ne=this;return D(function*(){u.isInstance({event:ae},FetchEvent);const se=ne.requestWrapper.fetchAndCache({request:ae.request}).catch(function(){return Response.error()}),ie=yield ne.requestWrapper.match({request:ae.request});return ie||(yield se)})()}}class BaseCacheManager{constructor(ae){this._entriesToCache=new Map,this._requestWrapper=new RequestWrapper({cacheName:ae,fetchOptions:{credentials:'same-origin'}}),this._cacheName=this._requestWrapper.cacheName}_addEntries(ae){this._parsedCacheUrls=null,ae.forEach((ne)=>{this._addEntryToInstallList(this._parseEntry(ne))})}getCacheName(){return this._cacheName}getCachedUrls(){return this._parsedCacheUrls||(this._parsedCacheUrls=Array.from(this._entriesToCache.keys()).map((ae)=>new URL(ae,location).href)),this._parsedCacheUrls}_addEntryToInstallList(ae){const ne=ae.entryID,se=this._entriesToCache.get(ae.entryID);return se?void this._onDuplicateInstallEntryFound(ae,se):void this._entriesToCache.set(ne,ae)}install(){var ae=this;return D(function*(){if(0!==ae._entriesToCache.size){const ne=[];return ae._entriesToCache.forEach(function(se){ne.push(ae._cacheEntry(se))}),Promise.all(ne)}})()}_cacheEntry(ae){var ne=this;return D(function*(){const se=yield ne._isAlreadyCached(ae);if(!se)try{return yield ne._requestWrapper.fetchAndCache({request:ae.getNetworkRequest(),waitOnCache:!0,cacheKey:ae.request}),ne._onEntryCached(ae)}catch(ie){throw T.createError('request-not-cached',{message:`Failed to get a cacheable response for `+`'${ae.request.url}': ${ie.message}`})}})()}cleanup(){var ae=this;return D(function*(){if(yield caches.has(ae._cacheName)){const ne=[];ae._entriesToCache.forEach(function(ce){ne.push(ce.request.url)});const se=yield ae._getCache(),ie=yield se.keys(),oe=ie.filter(function(ce){return!ne.includes(ce.url)});return Promise.all(oe.map(function(ce){return se.delete(ce)}))}})()}_getCache(){var ae=this;return D(function*(){return ae._cache||(ae._cache=yield caches.open(ae._cacheName)),ae._cache})()}_parseEntry(){throw T.createError('should-override')}_onDuplicateEntryFound(){throw T.createError('should-override')}_isAlreadyCached(){throw T.createError('should-override')}_onEntryCached(){throw T.createError('should-override')}}var W=createCommonjsModule(function(ae){'use strict';(function(){function toArray(se){return Array.prototype.slice.call(se)}function promisifyRequest(se){return new Promise(function(ie,oe){se.onsuccess=function(){ie(se.result)},se.onerror=function(){oe(se.error)}})}function promisifyRequestCall(se,ie,oe){var ce,le=new Promise(function(de,ue){ce=se[ie].apply(se,oe),promisifyRequest(ce).then(de,ue)});return le.request=ce,le}function promisifyCursorRequestCall(se,ie,oe){var ce=promisifyRequestCall(se,ie,oe);return ce.then(function(le){return le?new Cursor(le,ce.request):void 0})}function proxyProperties(se,ie,oe){oe.forEach(function(ce){Object.defineProperty(se.prototype,ce,{get:function(){return this[ie][ce]},set:function(le){this[ie][ce]=le}})})}function proxyRequestMethods(se,ie,oe,ce){ce.forEach(function(le){le in oe.prototype&&(se.prototype[le]=function(){return promisifyRequestCall(this[ie],le,arguments)})})}function proxyMethods(se,ie,oe,ce){ce.forEach(function(le){le in oe.prototype&&(se.prototype[le]=function(){return this[ie][le].apply(this[ie],arguments)})})}function proxyCursorRequestMethods(se,ie,oe,ce){ce.forEach(function(le){le in oe.prototype&&(se.prototype[le]=function(){return promisifyCursorRequestCall(this[ie],le,arguments)})})}function Index(se){this._index=se}function Cursor(se,ie){this._cursor=se,this._request=ie}function ObjectStore(se){this._store=se}function Transaction(se){this._tx=se,this.complete=new Promise(function(ie,oe){se.oncomplete=function(){ie()},se.onerror=function(){oe(se.error)},se.onabort=function(){oe(se.error)}})}function UpgradeDB(se,ie,oe){this._db=se,this.oldVersion=ie,this.transaction=new Transaction(oe)}function DB(se){this._db=se}proxyProperties(Index,'_index',['name','keyPath','multiEntry','unique']),proxyRequestMethods(Index,'_index',IDBIndex,['get','getKey','getAll','getAllKeys','count']),proxyCursorRequestMethods(Index,'_index',IDBIndex,['openCursor','openKeyCursor']),proxyProperties(Cursor,'_cursor',['direction','key','primaryKey','value']),proxyRequestMethods(Cursor,'_cursor',IDBCursor,['update','delete']),['advance','continue','continuePrimaryKey'].forEach(function(se){se in IDBCursor.prototype&&(Cursor.prototype[se]=function(){var ie=this,oe=arguments;return Promise.resolve().then(function(){return ie._cursor[se].apply(ie._cursor,oe),promisifyRequest(ie._request).then(function(ce){return ce?new Cursor(ce,ie._request):void 0})})})}),ObjectStore.prototype.createIndex=function(){return new Index(this._store.createIndex.apply(this._store,arguments))},ObjectStore.prototype.index=function(){return new Index(this._store.index.apply(this._store,arguments))},proxyProperties(ObjectStore,'_store',['name','keyPath','indexNames','autoIncrement']),proxyRequestMethods(ObjectStore,'_store',IDBObjectStore,['put','add','delete','clear','get','getAll','getKey','getAllKeys','count']),proxyCursorRequestMethods(ObjectStore,'_store',IDBObjectStore,['openCursor','openKeyCursor']),proxyMethods(ObjectStore,'_store',IDBObjectStore,['deleteIndex']),Transaction.prototype.objectStore=function(){return new ObjectStore(this._tx.objectStore.apply(this._tx,arguments))},proxyProperties(Transaction,'_tx',['objectStoreNames','mode']),proxyMethods(Transaction,'_tx',IDBTransaction,['abort']),UpgradeDB.prototype.createObjectStore=function(){return new ObjectStore(this._db.createObjectStore.apply(this._db,arguments))},proxyProperties(UpgradeDB,'_db',['name','version','objectStoreNames']),proxyMethods(UpgradeDB,'_db',IDBDatabase,['deleteObjectStore','close']),DB.prototype.transaction=function(){return new Transaction(this._db.transaction.apply(this._db,arguments))},proxyProperties(DB,'_db',['name','version','objectStoreNames']),proxyMethods(DB,'_db',IDBDatabase,['close']),['openCursor','openKeyCursor'].forEach(function(se){[ObjectStore,Index].forEach(function(ie){ie.prototype[se.replace('open','iterate')]=function(){var oe=toArray(arguments),ce=oe[oe.length-1],le=this._store||this._index,de=le[se].apply(le,oe.slice(0,-1));de.onsuccess=function(){ce(de.result)}}})}),[Index,ObjectStore].forEach(function(se){se.prototype.getAll||(se.prototype.getAll=function(ie,oe){var ce=this,le=[];return new Promise(function(de){ce.iterateCursor(ie,function(ue){return ue?(le.push(ue.value),void 0!==oe&&le.length==oe?void de(le):void ue.continue()):void de(le)})})})});ae.exports={open:function(se,ie,oe){var ce=promisifyRequestCall(indexedDB,'open',[se,ie]),le=ce.request;return le.onupgradeneeded=function(de){oe&&oe(new UpgradeDB(le.result,de.oldVersion,le.transaction))},ce.then(function(de){return new DB(de)})},delete:function(se){return promisifyRequestCall(indexedDB,'deleteDatabase',[se])}}})()});class IDBHelper{constructor(ae,ne,se){if(ae==void 0||ne==void 0||se==void 0)throw Error('name, version, storeName must be passed to the constructor.');this._name=ae,this._version=ne,this._storeName=se}_getDb(){return this._dbPromise?this._dbPromise:(this._dbPromise=W.open(this._name,this._version,(ae)=>{ae.createObjectStore(this._storeName)}).then((ae)=>{return ae}),this._dbPromise)}close(){return this._dbPromise?this._dbPromise.then((ae)=>{ae.close(),this._dbPromise=null}):void 0}put(ae,ne){return this._getDb().then((se)=>{const ie=se.transaction(this._storeName,'readwrite'),oe=ie.objectStore(this._storeName);return oe.put(ne,ae),ie.complete})}delete(ae){return this._getDb().then((ne)=>{const se=ne.transaction(this._storeName,'readwrite'),ie=se.objectStore(this._storeName);return ie.delete(ae),se.complete})}get(ae){return this._getDb().then((ne)=>{return ne.transaction(this._storeName).objectStore(this._storeName).get(ae)})}getAllValues(){return this._getDb().then((ae)=>{return ae.transaction(this._storeName).objectStore(this._storeName).getAll()})}getAllKeys(){return this._getDb().then((ae)=>{return ae.transaction(this._storeName).objectStore(this._storeName).getAllKeys()})}}let B=`sw-precaching-revisioned-${'v1'}`;self&&self.registration&&(B+=`-${self.registration.scope}`);const K=B;class RevisionDetailsModel{constructor(){this._idbHelper=new IDBHelper('sw-precaching','1','asset-revisions')}get(ae){return this._idbHelper.get(ae)}put(ae,ne){return this._idbHelper.put(ae,ne)}_close(){this._idbHelper.close()}}class BaseCacheEntry{constructor({entryID:ae,revision:ne,request:se,cacheBust:ie}){this.entryID=ae,this.revision=ne,this.request=se,this.cacheBust=ie}getNetworkRequest(){if(!0!==this.cacheBust)return this.request;let ae=this.request.url;const ne={};if(!0===this.cacheBust)if('cache'in Request.prototype)ne.cache='reload';else{const se=new URL(ae,location);se.search+=(se.search?'&':'')+encodeURIComponent('_sw-precaching')+'='+encodeURIComponent(this.revision),ae=se.toString()}return new Request(ae,ne)}}class StringCacheEntry extends BaseCacheEntry{constructor(ae){if(u.isType({url:ae},'string'),0===ae.length)throw T.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(ae)));super({entryID:ae,revision:ae,request:new Request(ae),cacheBust:!1})}}class DefaultsCacheEntry extends BaseCacheEntry{constructor({entryID:ae,revision:ne,url:se,cacheBust:ie}){if('undefined'==typeof ie&&(ie=!0),'undefined'==typeof ae&&(ae=new URL(se,location).toString()),u.isType({revision:ne},'string'),0===ne.length)throw T.createError('invalid-revisioned-entry',new Error('Bad revision Parameter. It should be a string with at least one character: '+JSON.stringify(ne)));if(u.isType({url:se},'string'),0===se.length)throw T.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(se)));if(u.isType({entryID:ae},'string'),0===ae.length)throw T.createError('invalid-revisioned-entry',new Error('Bad entryID Parameter. It should be a string with at least one character: '+JSON.stringify(ae)));u.isType({cacheBust:ie},'boolean'),super({entryID:ae,revision:ne,request:new Request(se),cacheBust:ie})}}class RevisionedCacheManager extends BaseCacheManager{constructor({cacheName:ae}={}){ae=ae||K,super(ae),this._revisionDetailsModel=new RevisionDetailsModel}addToCacheList({revisionedFiles:ae}={}){u.isInstance({revisionedFiles:ae},Array),super._addEntries(ae)}_parseEntry(ae){if('undefined'==typeof ae||null===ae)throw T.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ae)));let ne;switch(typeof ae){case'string':ne=new StringCacheEntry(ae);break;case'object':ne=new DefaultsCacheEntry(ae);break;default:throw T.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ne)));}return ne}_onDuplicateInstallEntryFound(ae,ne){if(ne.revision!==ae.revision)throw T.createError('duplicate-entry-diff-revisions',new Error(`${JSON.stringify(ne)} <=> `+`${JSON.stringify(ae)}`))}_isAlreadyCached(ae){var ne=this;return D(function*(){const se=yield ne._revisionDetailsModel.get(ae.entryID);if(se!==ae.revision)return!1;const ie=yield ne._getCache(),oe=yield ie.match(ae.request);return!!oe})()}_onEntryCached(ae){var ne=this;return D(function*(){yield ne._revisionDetailsModel.put(ae.entryID,ae.revision)})()}_close(){this._revisionDetailsModel._close()}cleanup(){return super.cleanup().then(()=>{return this._close()})}}class RequestCacheEntry extends BaseCacheEntry{constructor(ae){if(!(ae instanceof Request))throw T.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ae)));super({entryID:ae.url,request:ae,cacheBust:!1})}}class UnrevisionedCacheManager extends BaseCacheManager{constructor({cacheName:ae}={}){super(ae)}addToCacheList({unrevisionedFiles:ae}={}){u.isInstance({unrevisionedFiles:ae},Array),super._addEntries(ae)}_parseEntry(ae){if('undefined'==typeof ae||null===ae)throw T.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ae)));if('string'==typeof ae)return new StringCacheEntry(ae);if(ae instanceof Request)return new RequestCacheEntry(ae);throw T.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ae)))}_onDuplicateInstallEntryFound(){}_isAlreadyCached(){return D(function*(){return!1})()}_onEntryCached(){}}if(!u.isSWEnv())throw T.createError('not-in-sw');const V=`sw-cache-expiration-${self.registration.scope}`,H='url',$='timestamp',Y={'max-entries-or-age-required':`Either the maxEntries or maxAgeSeconds
    parameters (or both) are required when constructing Plugin.`,'max-entries-must-be-number':`The maxEntries parameter to the Plugin
    constructor must either be a number or undefined.`,'max-age-seconds-must-be-number':`The maxAgeSeconds parameter to the Plugin
    constructor must either be a number or undefined.`};var z=new ErrorFactory$1(Y);class Plugin{constructor({maxEntries:ae,maxAgeSeconds:ne}={}){if(!(ae||ne))throw z.createError('max-entries-or-age-required');if(ae&&'number'!=typeof ae)throw z.createError('max-entries-must-be-number');if(ne&&'number'!=typeof ne)throw z.createError('max-age-seconds-must-be-number');this.maxEntries=ae,this.maxAgeSeconds=ne,this._dbs=new Map,this._caches=new Map}getDB({cacheName:ae}={}){var ne=this;return D(function*(){u.isType({cacheName:ae},'string');const se=`${V}-${ae}`;if(!ne._dbs.has(se)){const ie=yield W.open(se,1,function(oe){const ce=oe.createObjectStore(ae,{keyPath:H});ce.createIndex($,$,{unique:!1})});ne._dbs.set(se,ie)}return ne._dbs.get(se)})()}getCache({cacheName:ae}={}){var ne=this;return D(function*(){if(u.isType({cacheName:ae},'string'),!ne._caches.has(ae)){const se=yield caches.open(ae);ne._caches.set(ae,se)}return ne._caches.get(ae)})()}cacheWillMatch({cachedResponse:ae,now:ne}={}){return this.isResponseFresh({cachedResponse:ae,now:ne})?ae:null}isResponseFresh({cachedResponse:ae,now:ne}={}){if(ae&&this.maxAgeSeconds){u.isInstance({cachedResponse:ae},Response);const se=ae.headers.get('date');if(se){'undefined'==typeof ne&&(ne=Date.now());const ie=new Date(se);if(ie.getTime()+1e3*this.maxAgeSeconds<ne)return!1}}return!0}cacheDidUpdate({cacheName:ae,newResponse:ne,url:se,now:ie}={}){u.isType({cacheName:ae},'string'),u.isInstance({newResponse:ne},Response),'undefined'==typeof ie&&(ie=Date.now()),this.updateTimestamp({cacheName:ae,url:se,now:ie}).then(()=>{this.expireEntries({cacheName:ae,now:ie})})}updateTimestamp({cacheName:ae,url:ne,now:se}={}){var ie=this;return D(function*(){u.isType({url:ne},'string'),u.isType({cacheName:ae},'string'),'undefined'==typeof se&&(se=Date.now());const oe=yield ie.getDB({cacheName:ae}),ce=oe.transaction(ae,'readwrite');ce.objectStore(ae).put({[$]:se,[H]:ne}),yield ce.complete})()}expireEntries({cacheName:ae,now:ne}={}){var se=this;return D(function*(){u.isType({cacheName:ae},'string'),'undefined'==typeof ne&&(ne=Date.now());const ie=se.maxAgeSeconds?yield se.findOldEntries({cacheName:ae,now:ne}):[],oe=se.maxEntries?yield se.findExtraEntries({cacheName:ae}):[],ce=[...new Set(ie.concat(oe))];return yield se.deleteFromCacheAndIDB({cacheName:ae,urls:ce}),ce})()}findOldEntries({cacheName:ae,now:ne}={}){var se=this;return D(function*(){u.isType({cacheName:ae},'string'),u.isType({now:ne},'number');const ie=ne-1e3*se.maxAgeSeconds,oe=[],ce=yield se.getDB({cacheName:ae}),le=ce.transaction(ae,'readonly'),de=le.objectStore(ae),ue=de.index($);return ue.iterateCursor(function(pe){pe&&(pe.value[$]<ie&&oe.push(pe.value[H]),pe.continue())}),yield le.complete,oe})()}findExtraEntries({cacheName:ae}={}){var ne=this;return D(function*(){u.isType({cacheName:ae},'string');const se=[],ie=yield ne.getDB({cacheName:ae});let oe=ie.transaction(ae,'readonly'),ce=oe.objectStore(ae),le=ce.index($);const de=yield le.count();return de>ne.maxEntries&&(oe=ie.transaction(ae,'readonly'),ce=oe.objectStore(ae),le=ce.index($),le.iterateCursor(function(ue){ue&&(se.push(ue.value[H]),de-se.length>ne.maxEntries&&ue.continue())})),yield oe.complete,se})()}deleteFromCacheAndIDB({cacheName:ae,urls:ne}={}){var se=this;return D(function*(){if(u.isType({cacheName:ae},'string'),u.isArrayOfType({urls:ne},'string'),0<ne.length){const ie=yield se.getCache({cacheName:ae}),oe=yield se.getDB({cacheName:ae});yield ne.forEach((()=>{var ce=D(function*(le){yield ie.delete(le);const de=oe.transaction(ae,'readwrite'),ue=de.objectStore(ae);yield ue.delete(le),yield de.complete});return function(){return ce.apply(this,arguments)}})())}})()}}const X={'channel-name-required':`The channelName parameter is required when
    constructing a new BroadcastCacheUpdate instance.`,'responses-are-same-parameters-required':`The first, second, and
    headersToCheck parameters must be valid when calling responsesAreSame()`};var J=new ErrorFactory$1(X);const Z='CACHE_UPDATED',Q=['content-length','etag','last-modified'];class BroadcastCacheUpdate{constructor({channelName:ae,headersToCheck:ne,source:se}={}){if('string'!=typeof ae||0===ae.length)throw J.createError('channel-name-required');this.channelName=ae,this.headersToCheck=ne||Q,this.source=se||'sw-broadcast-cache-update'}get channel(){return this._channel||(this._channel=new BroadcastChannel(this.channelName)),this._channel}notifyIfUpdated({first:ae,second:ne,cacheName:se}){u.isType({cacheName:se},'string'),responsesAreSame({first:ae,second:ne,headersToCheck:this.headersToCheck})||broadcastUpdate({cacheName:se,url:ne.url,channel:this.channel,source:this.source})}}class BroadcastCacheUpdatePlugin extends BroadcastCacheUpdate{cacheDidUpdate({cacheName:ae,oldResponse:ne,newResponse:se}){u.isType({cacheName:ae},'string'),u.isInstance({newResponse:se},Response),ne&&this.notifyIfUpdated({cacheName:ae,first:ne,second:se})}}class Plugin$1{constructor({statuses:ae,headers:ne}={}){u.atLeastOne({statuses:ae,headers:ne}),ae!==void 0&&u.isArrayOfType({statuses:ae},'number'),ne!==void 0&&u.isType({headers:ne},'object'),this.statuses=ae,this.headers=ne}cacheWillUpdate({response:ae}={}){return this.isResponseCacheable({response:ae})}isResponseCacheable({response:ae}={}){u.isInstance({response:ae},Response);let ne=!0;return this.statuses&&(ne=this.statuses.includes(ae.status)),this.headers&&ne&&(ne=Object.keys(this.headers).some((se)=>{return ae.headers.get(se)===this.headers[se]})),ne}}class SWLib{constructor(){this._router=new Router$$1,this._revisionedCacheManager=new RevisionedCacheManager,this._unrevisionedCacheManager=new UnrevisionedCacheManager,this._registerInstallActivateEvents(),this._registerDefaultRoutes()}cacheRevisionedAssets(ae){if(!Array.isArray(ae))throw r.createError('bad-revisioned-cache-list');this._revisionedCacheManager.addToCacheList({revisionedFiles:ae})}warmRuntimeCache(ae){if(!Array.isArray(ae))throw r.createError('bad-revisioned-cache-list');this._unrevisionedCacheManager.addToCacheList({unrevisionedFiles:ae})}get router(){return this._router}get Route(){return Route}cacheFirst(ae){return this._getCachingMechanism(CacheFirst,ae)}cacheOnly(ae){return this._getCachingMechanism(CacheOnly,ae)}networkFirst(ae){return this._getCachingMechanism(NetworkFirst,ae)}networkOnly(ae){return this._getCachingMechanism(NetworkOnly,ae)}staleWhileRevalidate(ae){return this._getCachingMechanism(StaleWhileRevalidate,ae)}_getCachingMechanism(ae,ne={}){const se={cacheExpiration:Plugin,broadcastCacheUpdate:BroadcastCacheUpdatePlugin,cacheableResponse:Plugin$1},ie={plugins:[]};ne.cacheName&&(ie.cacheName=ne.cacheName);const oe=Object.keys(se);return oe.forEach((ce)=>{if(ne[ce]){const le=se[ce],de=ne[ce];ie.plugins.push(new le(de))}}),ne.plugins&&ne.plugins.forEach((ce)=>{ie.plugins.push(ce)}),new ae({requestWrapper:new RequestWrapper(ie)})}_registerInstallActivateEvents(){self.addEventListener('install',(ae)=>{ae.waitUntil(Promise.all([this._revisionedCacheManager.install(),this._unrevisionedCacheManager.install()]))}),self.addEventListener('activate',(ae)=>{ae.waitUntil(Promise.all([this._revisionedCacheManager.cleanup(),this._unrevisionedCacheManager.cleanup()]))})}_registerDefaultRoutes(){const ae=this.cacheFirst({cacheName:this._revisionedCacheManager.getCacheName()}),ne=new this.Route({match:({url:se,event:ie})=>{const oe=this._revisionedCacheManager.getCachedUrls();return-1!==oe.indexOf(se.href)},handler:ae});this.router.registerRoute(ne)}}if(!u.isSWEnv())throw r.createError('not-in-sw');const te=new SWLib;return te});
//# sourceMappingURL=sw-lib.min.js.map
